<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="icon" href="immagini/SIGLA NERA.png?v=2" sizes="32x32" type="image/png">

    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/home.css">
</head>
<body>
    <!-- Popup Newsletter -->
    <div id="newsletterOverlay" class="newsletter-overlay">
        <div class="newsletter-popup">
            <span class="newsletter-close" onclick="closeNewsletter()">&times;</span>
            <h2>ISCRIVITI ALLA NEWSLETTER</h2>
            <p>Resta aggiornato sulle ultime novità di Corebody</p>
            <form id="newsletterForm" onsubmit="submitNewsletter(event)">
                <input type="email" id="newsletterEmail" placeholder="Inserisci la tua email" required>
                <button type="submit">ISCRIVITI</button>
            </form>
            <p class="newsletter-success" id="newsletterSuccess">Grazie per esserti iscritto!</p>
        </div>
    </div>

    <style>
        .newsletter-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }
        
        .newsletter-overlay.active {
            display: flex;
        }
        
        .newsletter-popup {
            background: #f5f0eb;
            padding: 40px;
            max-width: 450px;
            width: 90%;
            text-align: center;
            position: relative;
            animation: popupSlideIn 0.4s ease;
        }
        
        @keyframes popupSlideIn {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .newsletter-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 28px;
            cursor: pointer;
            color: #333;
            transition: color 0.3s;
        }
        
        .newsletter-close:hover {
            color: #000;
        }
        
        .newsletter-popup h2 {
            font-family: 'Times New Roman', serif;
            font-size: 24px;
            margin-bottom: 10px;
            letter-spacing: 2px;
            color: #333;
        }
        
        .newsletter-popup p {
            font-family: 'Arial', sans-serif;
            font-size: 14px;
            color: #666;
            margin-bottom: 25px;
        }
        
        .newsletter-popup form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .newsletter-popup input[type="email"] {
            padding: 15px;
            border: 1px solid #ccc;
            font-size: 14px;
            font-family: 'Arial', sans-serif;
            outline: none;
            transition: border-color 0.3s;
        }
        
        .newsletter-popup input[type="email"]:focus {
            border-color: #333;
        }
        
        .newsletter-popup button {
            padding: 15px;
            background: #333;
            color: #f5f0eb;
            border: none;
            font-size: 14px;
            letter-spacing: 2px;
            cursor: pointer;
            font-family: 'Arial', sans-serif;
            transition: background 0.3s;
        }
        
        .newsletter-popup button:hover {
            background: #000;
        }
        
        .newsletter-success {
            display: none;
            color: #2e7d32 !important;
            margin-top: 15px;
            margin-bottom: 0 !important;
        }
        
        .newsletter-success.show {
            display: block;
        }
        
        @media (max-width: 480px) {
            .newsletter-popup {
                padding: 30px 20px;
            }
            
            .newsletter-popup h2 {
                font-size: 20px;
            }
        }
    </style>

    <!-- Overlay per chiudere il menu -->
    <div id="overlay" class="overlay" onclick="closeMenu()"></div>

    <!-- Menu Sidebar -->
    <div id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <span class="close-btn" onclick="closeMenu()">&times;</span>
        </div>
        <div class="search-container">
            <input type="text" id="searchInput" class="search-input" placeholder="Cerca tra gli articoli..." onkeyup="searchArticles()">
            <img src="immagini/lente ricerca icon nera-05.png" alt="cerca" class="search-icon" onclick="toggleSearch()">
        </div>
        <div id="searchResults" class="search-results"></div>
        <a href="categoria.html?cat=fashion">FASHION</a>
        <a href="categoria.html?cat=beauty">BEAUTY AND WELLNESS</a>
        <a href="categoria.html?cat=art">ART</a>
        <a href="#">SHOP</a>
        <div class="basso">
        <a href="#">ABOUT</a>
        <a href="#">SUBMISSION</a>
        <a href="#">CONTACT</a>
        </div>
    </div>

    <main>
        <immagine_iniziale>
            <nav>
                <ul>
                    <destra>
                        <img id="menuIcon" src="immagini/MENU A TENDINA ICON BEIGE.png" alt="menu" style="height: 30px; width: 30px;" onclick="openMenu()">
                    </destra>
                    <sinistra>
                        <a href="https://www.instagram.com" target="_blank"><img src="immagini/IG ICON BEIGE.png" alt="instagram"></a>
                        <a href="https://www.tiktok.com" target="_blank"><img src="immagini/TIK TOK ICON BEIGE.png" alt="tiktok"></a>
                        <a href="https://www.pinterest.com" target="_blank"><img src="immagini/PINTEREST ICON BEIGE.png" alt="pinterest"></a>
                    </sinistra>
                </ul>
            </nav>
            <img src="immagini/FOTO HOME PAGE.jpg" alt="Immagine Iniziale">
            <img src="immagini/LOGO BEIGE.png" alt="Corebody" class="titolo">
                <span></span>
            </div>
        </immagine_iniziale>
        <section class="latest-section">
            <h1 class="latest-title">LATEST</h1>
            
            <div class="articles-grid" id="articlesGrid">
                <!-- Articoli caricati dinamicamente dal JSON -->
            </div>
        </section>
        <section class="chiusa">
            <div class="sezione_finale">
            <div class="scritta_centro">
                            <img src="immagini/LOGO NERO.png" alt="Corebody" class="titolo">
            <div class="basso">
                <a href="#">ABOUT</a>
                <a href="#">SUBMISSION</a>
                <a href="#">CONTACT</a>
                </div>
            </div>
            <div class="sotto" >
                        <a href="https://www.instagram.com" target="_blank"><img src="immagini/ig icon nera-01.png" alt="instagram"></a>
                        <a href="https://www.tiktok.com" target="_blank"><img src="immagini/tik tok icon nera-02.png" alt="tiktok"></a>
                        <a href="https://www.pinterest.com" target="_blank"><img src="immagini/pinterest icon nera-03.png" alt="pinterest"></a>
            </div>
            </div>
        </section>
    </main>


    </main>
<script>
// Variabile globale per gli articoli
var articoliData = [];

// Carica gli articoli dal JSON
fetch('articoli.json')
    .then(response => response.json())
    .then(articoli => {
        articoliData = articoli;
        var grid = document.getElementById('articlesGrid');
        
        articoli.forEach(function(art) {
            grid.innerHTML += `
                <article class="article-card" data-id="${art.id}" onclick="window.location='articolo.html?id=${art.id}'" style="cursor: pointer;">
                    <img src="${art.immagine}" alt="${art.categoria}" class="article-image">
                    <div class="article-content">
                        <h3 class="article-category">${art.categoria}</h3>
                        <p class="article-date">${art.data}</p>
                        <h2 class="article-title">${art.titolo}</h2>
                        <p class="article-text">${art.anteprima}</p>
                    </div>
                </article>
            `;
        });
    })
    .catch(error => console.error('Errore nel caricamento degli articoli:', error));

function openMenu() {
    // Su mobile apre a schermo intero, su desktop al 40%
    if (window.innerWidth <= 768) {
        document.getElementById("sidebar").style.width = "100%";
    } else {
        document.getElementById("sidebar").style.width = "40%";
    }
    document.getElementById("overlay").style.display = "block";
    document.getElementById("menuIcon").style.opacity = "0";
}

function closeMenu() {
    document.getElementById("sidebar").style.width = "0";
    document.getElementById("overlay").style.display = "none";
    document.getElementById("menuIcon").style.opacity = "1";
    document.getElementById("searchInput").style.display = "none";
    document.getElementById("searchInput").value = "";
    document.getElementById("searchResults").innerHTML = "";
}

function toggleSearch() {
    var searchInput = document.getElementById("searchInput");
    if (searchInput.style.display === "none" || searchInput.style.display === "") {
        searchInput.style.display = "block";
        searchInput.focus();
    } else {
        searchInput.style.display = "none";
        searchInput.value = "";
        document.getElementById("searchResults").innerHTML = "";
    }
}

function searchArticles() {
    var input = document.getElementById("searchInput").value.toLowerCase();
    var resultsContainer = document.getElementById("searchResults");
    resultsContainer.innerHTML = "";
    
    if (input.length < 2) {
        return;
    }
    
    // Cerca negli articoli dal JSON
    var foundArticles = articoliData.filter(function(art) {
        return art.titolo.toLowerCase().includes(input) || 
               art.categoria.toLowerCase().includes(input) || 
               art.anteprima.toLowerCase().includes(input) ||
               art.contenuto.toLowerCase().includes(input);
    });
    
    if (foundArticles.length === 0) {
        resultsContainer.innerHTML = "<p class='no-results'>Nessun risultato trovato</p>";
        return;
    }
    
    // Mostra massimo 3 risultati
    var maxResults = Math.min(foundArticles.length, 3);
    for (var i = 0; i < maxResults; i++) {
        var art = foundArticles[i];
        var resultItem = document.createElement("a");
        resultItem.href = "articolo.html?id=" + art.id;
        resultItem.className = "search-result-item";
        resultItem.textContent = art.titolo + " (" + art.categoria + ")";
        resultsContainer.appendChild(resultItem);
    }
    
    // Se ci sono più di 3 risultati, mostra "di più"
    if (foundArticles.length > 3) {
        localStorage.setItem('searchResults', JSON.stringify(foundArticles));
        
        var moreLink = document.createElement("a");
        moreLink.href = "ricerca.html";
        moreLink.className = "search-more-link";
        moreLink.textContent = "di più (" + (foundArticles.length - 3) + " altri)";
        resultsContainer.appendChild(moreLink);
    }
}

// ===== SCROLL ANIMATIONS =====
// Intersection Observer per animazioni al scroll
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry, index) => {
        if (entry.isIntersecting) {
            // Aggiungi delay progressivo per le card
            if (entry.target.classList.contains('article-card')) {
                setTimeout(() => {
                    entry.target.classList.add('visible');
                }, index * 100);
            } else {
                entry.target.classList.add('visible');
            }
        }
    });
}, observerOptions);

// Osserva elementi quando il DOM è pronto
document.addEventListener('DOMContentLoaded', function() {
    // Osserva il titolo LATEST
    const latestTitle = document.querySelector('.latest-title');
    if (latestTitle) observer.observe(latestTitle);
    
    // Osserva le card dopo che sono state caricate
    setTimeout(() => {
        document.querySelectorAll('.article-card').forEach(card => {
            observer.observe(card);
        });
    }, 500);
    
    // Mostra popup newsletter dopo 2 secondi (solo se non già iscritto)
    if (!localStorage.getItem('newsletterSubscribed')) {
        setTimeout(() => {
            document.getElementById('newsletterOverlay').classList.add('active');
        }, 500);
    }
});

// ===== NEWSLETTER POPUP =====
function closeNewsletter() {
    document.getElementById('newsletterOverlay').classList.remove('active');
}

// URL del tuo Google Apps Script - SOSTITUISCI con il tuo URL dopo il deploy
var GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyDJ-gAtJx77iI1iO7aeW-AGVsubv1rLG3pvuxhnmGOBaS9eFBUrlx1F7blMN7fiRD3sg/exec';

function submitNewsletter(event) {
    event.preventDefault();
    var email = document.getElementById('newsletterEmail').value;
    var submitBtn = document.querySelector('.newsletter-popup button');
    
    // Disabilita il bottone durante l'invio
    submitBtn.disabled = true;
    submitBtn.textContent = 'INVIO IN CORSO...';
    
    // Invia richiesta a Google Apps Script
    fetch(GOOGLE_SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email: email })
    })
    .then(function() {
        console.log('Richiesta inviata con successo!');
        
        // Mostra messaggio di successo
        document.getElementById('newsletterForm').style.display = 'none';
        document.getElementById('newsletterSuccess').classList.add('show');
        
        // Salva che l'utente si è iscritto
        localStorage.setItem('newsletterSubscribed', 'true');
        
        // Chiudi popup dopo 2 secondi
        setTimeout(() => {
            closeNewsletter();
        }, 2000);
    })
    .catch(function(error) {
        console.error('Errore:', error);
        submitBtn.disabled = false;
        submitBtn.textContent = 'ISCRIVITI';
        alert('Si è verificato un errore. Riprova più tardi.');
    });
}

// Chiudi popup cliccando fuori
document.getElementById('newsletterOverlay').addEventListener('click', function(e) {
    if (e.target === this) {
        closeNewsletter();
    }
});


</script>
</body>
</html>
